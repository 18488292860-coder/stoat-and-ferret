# Impact Assessment Table — v005

| # | Area | Description | Classification | Resulting Work Item | Caused By |
|---|------|-------------|----------------|---------------------|-----------|
| 1 | CI/CD Pipeline | CI workflow (`ci.yml`) only watches `src/`, `rust/`, `tests/` paths. Adding `gui/` directory with npm/Vite build, Vitest, and Playwright requires new CI jobs and path filters. | substantial | Add `gui/**` to path filters, add Node.js setup step, add `npm run build` and `npm test` steps to test matrix. Add Playwright E2E job with FastAPI server startup. | BL-028 (frontend scaffolding), BL-036 (E2E tests) |
| 2 | CI/CD Pipeline | Playwright E2E tests (BL-036) need a CI job that builds the frontend, starts FastAPI serving static files, and runs browser tests. This is a new CI job type not currently in the workflow. | small | Add Playwright CI job within BL-036 implementation — install browsers, build frontend, start server, run tests. | BL-036 (E2E tests) |
| 3 | Quality Gates | `run_quality_gates` MCP tool currently supports Python checks (ruff, mypy, pytest) and Rust checks (cargo-test, cargo-clippy). v005 introduces a TypeScript/Node frontend requiring npm-test and tsc checks. The tool already supports these check types but the project's auto-detection from manifest files will need a `gui/package.json` to trigger them. | substantial | Ensure `gui/package.json` includes `test` and `build` scripts so auto-detection works. Verify `run_quality_gates` with `checks=["npm-test", "tsc"]` runs correctly from project root. Update AGENTS.md quality gate commands to include frontend. | BL-028 (frontend scaffolding), BL-036 (E2E tests) |
| 4 | API Specification | `docs/design/05-api-specification.md` does not document a `/api/videos/{id}/thumbnail` endpoint. BL-032 adds this endpoint. Also, list endpoint responses already show `total` in the spec but BL-034 notes the implementation is missing — spec is correct but implementation diverges. | substantial | Add `GET /api/videos/{id}/thumbnail` endpoint documentation to API spec. Verify existing `total` field documentation matches BL-034 implementation. Add `/ws` WebSocket endpoint documentation. | BL-032 (thumbnails), BL-034 (pagination), BL-029 (WebSocket) |
| 5 | App Factory | `create_app()` in `src/stoat_ferret/api/app.py` does not mount static files or include a WebSocket router. v005 requires both. The app factory's DI pattern needs extension for WebSocket connection manager injection. | small | Add `StaticFiles` mount for `/gui/*` route pointing to `gui/dist/`. Add WebSocket router include. Extend `create_app()` kwargs to accept optional WebSocket connection manager for test injection. | BL-028 (frontend scaffolding), BL-029 (WebSocket), BL-003 (static file serving) |
| 6 | App Factory | The lifespan handler needs to initialize and clean up WebSocket connection manager alongside the existing job queue worker. | small | Add WebSocket manager startup/shutdown to lifespan. Initialize connection manager, store on `app.state`. Clean up on shutdown. | BL-029 (WebSocket) |
| 7 | Documentation | `docs/design/02-architecture.md` references Web UI as "(Future)" in the client layer diagram. v005 makes it current. The architecture diagram's endpoint groups list doesn't include `/ws` or `/gui/*`. | small | Update client layer diagram to remove "(Future)" from Web UI. Add `/ws` and `/gui/*` to endpoint groups. Add WebSocket to communication patterns. | BL-028, BL-029, BL-030 |
| 8 | Documentation | `docs/design/01-roadmap.md` Phase 1 milestones M1.10-M1.12 reference GUI work but are listed as unchecked. After v005 implementation these should reflect completion. | small | Update roadmap milestones M1.10-M1.12 checklist items to reflect v005 completion after implementation. This is a post-implementation task. | All GUI backlog items |
| 9 | Documentation | `AGENTS.md` quality gate commands section only lists Python and Rust commands. v005 adds frontend commands (npm test, npm run build, npx playwright test). | small | Add frontend quality gate commands section to AGENTS.md: `cd gui && npm test`, `cd gui && npm run build`, `cd gui && npx playwright test`. | BL-028 (frontend scaffolding), BL-036 (E2E tests) |
| 10 | Documentation | `docs/design/04-technical-stack.md` lists GUI/Frontend technologies as decision options (React or Svelte). BL-028 makes the framework selection — the doc should be updated to reflect the chosen framework. | small | Update technical stack document to reflect the selected framework (React vs Svelte) once BL-028 decision is made. | BL-028 (frontend scaffolding) |
| 11 | Project Structure | The `gui/` directory does not exist. All v005 GUI features depend on it being scaffolded first. `pyproject.toml` and `hatch` build configuration may need updates if the frontend build is integrated into the Python packaging workflow. | small | Scaffold `gui/` directory per BL-028. Verify `pyproject.toml` doesn't need changes (frontend is built separately via npm, served as static files). Add `gui/dist/` to `.gitignore`. | BL-028 (frontend scaffolding) |
| 12 | Settings | `Settings` class in `api/settings.py` has no configuration for WebSocket, static file paths, or thumbnail storage. v005 features need configurable thumbnail directory, static file path, and WebSocket settings. | small | Add settings fields: `thumbnail_dir` (default `data/thumbnails`), `gui_static_path` (default `gui/dist`), optional WebSocket config (heartbeat interval, max connections). | BL-029 (WebSocket), BL-032 (thumbnails), BL-003 (static files) |
