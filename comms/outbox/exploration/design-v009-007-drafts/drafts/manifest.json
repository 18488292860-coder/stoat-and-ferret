{
  "version": "v009",
  "description": "Complete the observability pipeline (FFmpeg metrics, audit logging, file-based logs) and fix GUI runtime gaps (SPA routing, pagination, WebSocket broadcasts).",
  "backlog_ids": ["BL-057", "BL-059", "BL-060", "BL-063", "BL-064", "BL-065"],
  "context": {
    "rationale": "All 6 items are wiring gaps — existing components and infrastructure built in earlier versions but never connected. No new functionality is being built.",
    "constraints": [
      "BL-057 depends on BL-056 (structured logging, completed in v008)",
      "Theme 1 modifies app.py startup/DI; Theme 2 modifies API routers — sequential to avoid conflicts",
      "SPA fallback route must be conditional on gui/dist/ directory existing (LRN-020)",
      "AuditLogger requires a separate sync sqlite3.Connection (aiosqlite has no public sync access)"
    ],
    "assumptions": [
      "All referenced classes and infrastructure exist with expected interfaces (verified in Task 004)",
      "Frontend already handles WebSocket events correctly (ActivityLog parses event payloads)",
      "The create_app() DI pattern handles test double injection without wrapping (verified in Task 006)"
    ],
    "deferred_items": []
  },
  "themes": [
    {
      "number": 1,
      "slug": "observability-pipeline",
      "goal": "Wire the three observability components that exist as dead code into the application's DI chain and startup sequence.",
      "features": [
        {
          "number": 1,
          "slug": "ffmpeg-observability",
          "goal": "Wire ObservableFFmpegExecutor into DI so FFmpeg operations emit metrics and structured logs."
        },
        {
          "number": 2,
          "slug": "audit-logging",
          "goal": "Wire AuditLogger into repository DI with a separate sync connection so database mutations produce audit entries."
        },
        {
          "number": 3,
          "slug": "file-logging",
          "goal": "Add RotatingFileHandler to configure_logging() for persistent log output to rotating files."
        }
      ]
    },
    {
      "number": 2,
      "slug": "gui-runtime-fixes",
      "goal": "Fix three runtime gaps in the GUI and API layer: SPA routing, pagination totals, and WebSocket broadcasts.",
      "features": [
        {
          "number": 1,
          "slug": "spa-routing",
          "goal": "Replace StaticFiles mount with catch-all route that serves both static files and SPA fallback."
        },
        {
          "number": 2,
          "slug": "pagination-fix",
          "goal": "Add count() to AsyncProjectRepository, fix total in API, and add frontend pagination UI."
        },
        {
          "number": 3,
          "slug": "websocket-broadcasts",
          "goal": "Wire broadcast() into scan service and project router for real-time WebSocket events."
        }
      ]
    }
  ]
}
