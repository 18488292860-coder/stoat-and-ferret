# Impact Table - v006

| # | Area | Description | Classification | Resulting Work Item | Caused By |
|---|------|-------------|----------------|---------------------|-----------|
| 1 | AGENTS.md | Rust module structure section lists `timeline`, `filters`, `commands`, `sanitize`, `layout`, `render`, `hardware` — v006 adds new modules for expressions, graph validation, composition, drawtext builder, speed builder that are not listed | small | Update AGENTS.md Rust module list to include new v006 modules after implementation | BL-037, BL-038, BL-039, BL-040, BL-041 |
| 2 | Type stubs | `stubs/stoat_ferret_core/_core.pyi` will need updates for every new PyO3-exposed type (expression builders, composition API, drawtext builder, speed builder) | small | Regenerate type stubs after each feature adding PyO3 bindings (per Incremental Binding Rule in AGENTS.md) | BL-037, BL-039, BL-040, BL-041 |
| 3 | Rust coverage | Rust coverage is at 75% (target 90%, tech debt from v004). v006 adds substantial Rust code — new modules must maintain high coverage or the gap widens further | small | Include coverage target (>=90%) in acceptance criteria for each Rust feature; track in quality gates | BL-037, BL-038, BL-039, BL-040, BL-041 |
| 4 | `docs/design/02-architecture.md` | Architecture doc's Rust Core section (line 376-387) lists module structure without expression engine, graph validation, or composition modules. The Filter Builder box is generic — doesn't reflect the expression AST, graph validator, or composition system being added | substantial | Update architecture doc Rust module structure, add expression engine and graph validation to architecture diagram, update Effects Service responsibilities | BL-037, BL-038, BL-039 |
| 5 | `docs/design/02-architecture.md` | The Python/Rust boundary description (lines 138-159) lists Rust responsibilities as "FFmpeg command generation (filter chains, encoding presets)". v006 adds expression construction, graph validation, and filter composition as new Rust responsibilities not currently documented | small | Update Python/Rust boundary description to include expression construction, graph validation, and filter composition as Rust responsibilities | BL-037, BL-038, BL-039 |
| 6 | `docs/design/05-api-specification.md` | The API spec already describes `/effects` endpoints, effect schemas, and clip effect application (lines 654-937). v006 implements these — if implementation matches the spec, no update needed. If the actual API diverges (different parameter names, additional fields, different error codes), the spec must be updated | small | Verify API spec accuracy after implementing BL-042 (effect discovery) and BL-043 (clip effect application); update any divergences | BL-042, BL-043 |
| 7 | C4 documentation | C4 architecture documentation was not updated for v005 (noted in retrospective). v006 adds significant new Rust modules and a new Python Effects Service. The C4 gap will grow further | substantial | Create or update C4 documentation to cover the effects engine components (expression engine, graph validator, composition system, effect builders, Effects Service, effect discovery API) | BL-037, BL-038, BL-039, BL-040, BL-041, BL-042, BL-043 |
| 8 | Clip data model | BL-043 requires storing effect configurations in the clip/project model, but the current clip model has no `effects` field for persistent storage. The API spec shows effects in clip responses (line 469: `"effects": []`) but the actual data model (`src/stoat_ferret/api/schemas/clip.py`, `src/stoat_ferret/db/clip_repository.py`) must be verified and extended | substantial | Design and implement clip effect storage model extension — add effects field to clip schema, update clip repository, define effect configuration persistence format | BL-043 |
